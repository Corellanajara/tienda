<script type="text/javascript" src="{{theme}}/js/jquery-1.8.2.min.js"></script> {# LLAMADA A JQUERY #}
<script src="{{theme}}/js/modernizr.custom.12319.js"></script> {# MODERNIZR #}
<!-- JQUERY UI -->
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script> <!-- jQuery UI -->  
<script src="{{theme}}/js/albatronic.js"></script>
<script src="{{theme}}/js/pirobox_extended.js"></script>
<script src="{{theme}}/js/pirobox_function.js"></script> {# pirobox #}
<!-- SLIDER HOME -->
<script src="{{theme}}/js/bjqs-1.3.min.js"></script>
<script src="{{theme}}/js/bjqs-function.js"></script>
<script src="{{theme}}/js/jcarousellite.js" type="text/javascript"></script>
<script src="//use.edgefonts.net/open-sans.js"></script>
<script>
$(function(){
    $('#zonaEnvio').change(function(){
        updateGastos('20.00');
    })
    $('#formaPago').change(function(){
        updateGastos('25.00');        
    })
    $('#metodoEnvio').change(function(){
        updateGastos('30.00');       
    })
});

function updateGastos(gastos) {
    $('#gastosEnvio').html(gastos);
}

function actualizar(idLinea) {
    if ($('#unidades'+idLinea).val()<=0) return;

    var datos = {
        'IDLinea' : idLinea,
        'Unidades' : $('#unidades'+idLinea).val()
    }

    $.ajax({
        url: appPath + '/lib/carrito.php',
        dataType: 'html',
        type: 'post',
        data: {'parametros': {'accion': 'update', 'datos': datos} },
        success: function(resultado) {
            var datos = $.parseJSON(resultado);  
            if (datos.status === 'error') {
                $('#mensajes').html(datos.errores);
                $('#mensajes').dialog('open');
            } else {
                $('#importe'+idLinea).html(datos.linea.Importe);
                $('#total').html(datos.totales.Importe);
            }
        }
    });        
}

function eliminar(idLinea) {
    if (!confirm('{{values.LABELS.deseaEliminarDeLaCestaElProducto}}')) return;

    var datos = {
        'IDLinea' : idLinea
    }

    $.ajax({
        url: appPath + '/lib/carrito.php',
        dataType: 'html',
        type: 'post',
        data: {'parametros': {'accion': 'remove', 'datos': datos} },
        success: function(resultado) {
            var datos = $.parseJSON(resultado);  
            if (datos.status === 'error') {
                $('#mensajes').html(datos.errores);
                $('#mensajes').dialog('open');
            } else {
                $('#linea'+idLinea).remove();
                if (datos.totales.Unidades !== null) {
                    $('#total').html(datos.totales.Importe);
                } else {
                    window.location.href = "{{app.path}}/carrito";                        
                }
            }
        }
    });         
}
</script>